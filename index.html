<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Weather App</title>

  <!-- Libraries -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap">

  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: 'Montserrat', sans-serif;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      align-items: center;
      min-height: 100vh;
      background: linear-gradient(to right, #4CAF50, #2196F3);
      transition: background 0.8s ease-in-out;
    }

    header {
      width: 100%;
      padding: 15px 0;
      text-align: center;
      font-size: 1.8rem;
      color: white;
      background: rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(6px);
      font-weight: bold;
      letter-spacing: 1px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
    }

    footer {
      width: 100%;
      padding: 10px 0;
      text-align: center;
      color: white;
      font-size: 14px;
      background: rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(6px);
      letter-spacing: 0.5px;
      box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.3);
    }

    /* MAIN PAGE GRID */
    .container {
      width: 100%;
      max-width: 1400px;
      display: flex;
      flex-direction: column;
      gap: 20px;
      padding: 20px;
    }

    /* TOP ROW - 3 CARD LAYOUT */
    .top-row {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      width: 100%;
    }

    /* BOTTOM ROW - FORECAST LINE */
    .bottom-row {
      width: 100%;
      display: flex;
      justify-content: center;
    }

    /* Shared styles for all boxes */
    .weather-card,
    .info-box {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 20px;
      padding: 25px;
      width: 380px;
      min-height: 500px;
      box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.18);
      transition: transform 0.4s ease, box-shadow 0.4s ease;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
    }

    /* FORECAST BOX LARGE WIDTH */
    #forecast-box {
      width: 100%;
      max-width: 1200px;
      min-height: 450px;
    }

    .weather-card:hover,
    .info-box:hover {
      transform: scale(1.05);
      box-shadow: 0 0 40px rgba(0, 0, 0, 0.2);
    }

    h1 {
      color: #fff;
      font-weight: 700;
      margin-bottom: 20px;
      text-align: center;
    }

    #weather-info {
      display: none;
      color: #333;
      margin-top: 15px;
      animation: fadeIn 1s;
    }

    #weather-icon {
      width: 100px;
      height: 100px;
      display: block;
      margin: 10px auto;
    }

    #temperature {
      font-size: 32px;
      font-weight: bold;
      margin: 10px 0;
      text-align: center;
      transition: color 0.5s;
    }

    #description,
    #wind-speed,
    #date {
      font-size: 18px;
      text-align: center;
    }

    .input-group {
      display: flex;
      gap: 10px;
      margin-bottom: 15px;
    }

    .input-group input,
    .input-group button {
      flex: 1;
      font-size: 16px;
      padding: 12px;
      border-radius: 5px;
      border: none;
    }

    .info-box h2 {
      color: #fff;
      font-size: 1.5rem;
      margin-bottom: 15px;
      border-bottom: 2px solid rgba(255, 255, 255, 0.3);
      padding-bottom: 10px;
      text-align: center;
    }

    #forecast-content {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .forecast-day {
      background: rgba(255, 255, 255, 0.15);
      border-radius: 12px;
      padding: 12px 15px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-left: 4px solid #2196F3;
      transition: transform 0.3s ease;
    }

    .forecast-day:hover {
      transform: translateX(5px);
      background: rgba(255, 255, 255, 0.25);
    }

    .forecast-date,
    .forecast-temp,
    .forecast-desc {
      color: #fff;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>

<body>
  <header>üå¶ Live Weather Dashboard</header>

  <div class="container">

    <!-- TOP 3 CARDS -->
    <div class="top-row">

      <!-- Weather Card -->
      <div class="weather-card animate__animated animate__fadeIn">
        <h1>Weather App</h1>
        <div class="input-group">
          <input type="text" id="city-input" placeholder="Enter city name">
          <button id="city-input-btn">Get Weather</button>
        </div>

        <div id="weather-info">
          <h3 id="city-name"></h3>
          <p id="date"></p>
          <img id="weather-icon" alt="Weather Icon">
          <p id="temperature"></p>
          <p id="description"></p>
          <p id="wind-speed"></p>
        </div>
      </div>

      <!-- Weather Suggestions -->
      <div class="info-box animate__animated animate__fadeIn" id="suggestions-box">
        <h2>üí° Weather Suggestions</h2>
        <div class="content">
          <div id="ai-recommendation-text" style="color: #fff; line-height: 1.8; padding: 10px;">
            <p style="text-align: center;">Loading suggestions...</p>
          </div>
        </div>
      </div>

      <!-- City Facts -->
      <div class="info-box animate__animated animate__fadeIn" id="facts-box">
        <h2>üìç About This City</h2>
        <div class="content" id="facts-content">
          <p style="text-align: center; color: #fff;">Loading city information...</p>
        </div>
      </div>

    </div> <!-- END TOP ROW -->

    <!-- BOTTOM FORECAST ROW -->
    <div class="bottom-row">
      <div class="info-box animate__animated animate__fadeIn" id="forecast-box">
        <h2>üìÖ 5-Day Weather Forecast</h2>
        <div class="content" id="forecast-content">
          <p style="text-align: center; color: #fff;">Loading forecast...</p>
        </div>
      </div>
    </div>

  </div> <!-- END CONTAINER -->

  <footer>üåç Created by <strong>Ishan, Karn and Hemant</strong> | CSE - 19 ¬©</footer>


  <!-- JS LIBRARIES -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://momentjs.com/downloads/moment.min.js"></script>

  <!-- ORIGINAL JAVASCRIPT (unchanged) -->
  <script>
  /* ‚≠ê‚≠ê NOTE: Your entire JavaScript code remains unchanged ‚≠ê‚≠ê */
  /* I am NOT removing or editing your JS logic ‚Äî only layout was fixed. */
  
  /* YOUR JS CODE STARTS HERE (I DID NOT MODIFY IT AT ALL) */

  const apiKey = 'c17e9bbcc16e48228db140044250109';
  const openWeatherApiKey = '7c405e1d16d21803d265b7c0a044b740';
  const supabaseUrl = 'https://deqhaidxaxpfcffwxxkj.supabase.co';

  $(document).ready(function () {
    weatherFn('Pune');
  });

  async function weatherFn(city) {
    const url = `https://api.weatherapi.com/v1/current.json?key=${apiKey}&q=${city}&aqi=no`;

    try {
      const res = await fetch(url);
      const data = await res.json();

      if (res.ok) weatherShowFn(data);
      else $('#weather-info, #suggestions-box, #facts-box').hide();
    } catch (error) {
      console.error(error);
      $('#weather-info, #suggestions-box, #facts-box').hide();
    }
  }

  function weatherShowFn(data) {
    $('#city-name').text(data.location.name);
    $('#date').text(moment().format('MMMM Do YYYY, h:mm:ss a'));
    $('#temperature').html(`${data.current.temp_c}¬∞C`);
    $('#description').text(data.current.condition.text);
    $('#wind-speed').html(`üí® Wind Speed: ${data.current.wind_kph} km/h`);
    $('#weather-icon').attr('src', `https:${data.current.condition.icon}`);
    $('#weather-info').fadeIn();

    const temp = data.current.temp_c;

    let bg;
    if (temp < 0) bg = 'linear-gradient(to right, #0f2027, #203a43, #2c5364)';
    else if (temp < 15) bg = 'linear-gradient(to right, #56CCF2, #2F80ED)';
    else if (temp < 30) bg = 'linear-gradient(to right, #43C6AC, #191654)';
    else bg = 'linear-gradient(to right, #FF512F, #DD2476)';

    $('body').css('background', bg);

    if (temp < 0) $('#temperature').css('color', '#00BFFF');
    else if (temp < 15) $('#temperature').css('color', '#2196F3');
    else if (temp < 30) $('#temperature').css('color', '#FF9800');
    else $('#temperature').css('color', '#E53935');

    getTemperatureSuggestions(data);
    fetchCityFacts(data.location.name, data.location.country);
    getFiveDayForecast(data.location.name);
  }

  function getTemperatureSuggestions(weatherData) {
    const temp = weatherData.current.temp_c;
    let suggestions = [];

    if (temp < 5) {
      suggestions = [
        '1. Wear multiple layers including thermal underwear and a heavy winter coat.',
        '2. Cover your head, hands, and feet with warm accessories to prevent frostbite.',
        '3. Stay indoors as much as possible and limit outdoor exposure.',
        '4. Drink warm beverages to maintain body temperature.',
        '5. Check on elderly neighbors and ensure heating systems are working properly.'
      ];
    } else if (temp < 10) {
      suggestions = [
        '1. Wear a warm jacket, sweater, and long pants for comfort.',
        '2. Keep a scarf and gloves handy for early morning or evening outings.',
        '3. Great weather for brisk walks or jogging with proper clothing.',
        '4. Hot drinks like coffee or tea will help keep you warm.',
        '5. Perfect time for indoor activities or cozy gatherings.'
      ];
    } else if (temp < 15) {
      suggestions = [
        '1. Light jacket or cardigan is recommended for outdoor activities.',
        '2. Ideal weather for hiking, cycling, or outdoor sports.',
        '3. Layer your clothing so you can adjust as temperatures change.',
        '4. Comfortable temperature for sightseeing and exploring the city.',
        '5. Great time to enjoy outdoor cafes without being too cold or hot.'
      ];
    } else if (temp < 20) {
      suggestions = [
        '1. Comfortable clothing with a light sweater for cooler moments.',
        '2. Perfect weather for all outdoor activities and exercise.',
        '3. Great day for picnics, parks, and outdoor events.',
        '4. Ideal temperature for walking, running, or cycling.',
        '5. No need for heavy clothing, enjoy the pleasant weather.'
      ];
    } else if (temp < 25) {
      suggestions = [
        '1. Wear light, breathable clothing like t-shirts and shorts.',
        '2. Apply sunscreen if spending extended time outdoors.',
        '3. Perfect weather for beach visits, swimming, or water activities.',
        '4. Stay hydrated and carry a water bottle with you.',
        '5. Great time for outdoor dining and evening walks.'
      ];
    } else if (temp < 30) {
      suggestions = [
        '1. Wear loose, light-colored clothing to stay cool.',
        '2. Use sunglasses and a hat to protect from direct sunlight.',
        '3. Drink plenty of water throughout the day to stay hydrated.',
        '4. Seek shade during peak afternoon hours (12 PM - 3 PM).',
        '5. Apply and reapply sunscreen every 2 hours if outdoors.'
      ];
    } else {
      suggestions = [
        '1. Wear minimal, light-colored, and breathable clothing.',
        '2. Avoid outdoor activities during peak heat hours (11 AM - 4 PM).',
        '3. Drink water frequently even if you don\'t feel thirsty.',
        '4. Stay in air-conditioned spaces as much as possible.',
        '5. Watch for signs of heat exhaustion: dizziness, nausea, or excessive sweating.'
      ];
    }

    const html = suggestions.map(s => `<p>${s}</p>`).join('');
    $('#ai-recommendation-text').html(html);
  }

  async function fetchCityFacts(cityName, country) {
    $('#facts-box h2').html(`üìç About ${cityName}`);
    $('#facts-content').html('<p style="text-align:center;color:#fff;">Loading city information...</p>');

    const url = `https://en.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(cityName)}`;

    try {
      const res = await fetch(url);
      const data = await res.json();

      if (res.ok && data.extract) displayCityFacts(data, cityName, country);
      else $('#facts-content').html(`<p style="color:#fff;">No info found.</p>`);
    } catch {
      $('#facts-content').html(`<p style="color:#fff;">Unable to load info.</p>`);
    }
  }

  function displayCityFacts(data, cityName, country) {
    const extract = data.extract;
    const thumbnail = data.thumbnail ? data.thumbnail.source : '';

    let html = `<p style="text-align:center;"><strong>${cityName}, ${country}</strong></p>`;
    if (thumbnail) html += `<img src="${thumbnail}" style="max-width:100%;border-radius:10px;">`;

    html += `<p>${extract.split('. ').slice(0, 3).join('. ')}...</p>`;
    $('#facts-content').html(html);
  }

  async function getFiveDayForecast(city) {
    const url = `https://api.openweathermap.org/data/2.5/forecast?q=${city}&appid=${openWeatherApiKey}&units=metric`;

    try {
      const res = await fetch(url);
      const data = await res.json();

      if (res.ok) displayForecast(data);
      else $('#forecast-content').html('<p style="color:#fff;">Unable to load forecast.</p>');
    } catch {
      $('#forecast-content').html('<p style="color:#fff;">Unable to load forecast.</p>');
    }
  }

  function displayForecast(data) {
    const daily = {};
    data.list.forEach(item => {
      const date = moment(item.dt * 1000).format("YYYY-MM-DD");
      const temp = item.main.temp;

      if (!daily[date]) {
        daily[date] = {
          minTemp: temp,
          maxTemp: temp,
          item: item
        };
      } else {
        if (temp < daily[date].minTemp) daily[date].minTemp = temp;
        if (temp > daily[date].maxTemp) daily[date].maxTemp = temp;
      }
    });

    const days = Object.keys(daily).slice(0, 5);
    let html = '';

    days.forEach(date => {
      const d = daily[date];
      html += `
        <div class="forecast-day">
          <div class="forecast-date">${moment(d.item.dt * 1000).format("ddd, MMM D")}</div>
          <div><img src="https://openweathermap.org/img/wn/${d.item.weather[0].icon}@2x.png" width="50"></div>
          <div class="forecast-temp"><span style="color: #FF6B6B;">H: ${Math.round(d.maxTemp)}¬∞</span> <span style="color: #4ECDC4;">L: ${Math.round(d.minTemp)}¬∞</span></div>
          <div class="forecast-desc">${d.item.weather[0].description}</div>
        </div>`;
    });

    $('#forecast-content').html(html);
  }

  $('#city-input-btn').on('click', function () {
    const c = $('#city-input').val().trim();
    if (c) weatherFn(c);
  });

  </script>

</body>
</html>
